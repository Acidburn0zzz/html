<!DOCTYPE html>
<html lang="en-US-x-Hixie"><head><title>6.5 System state and capabilities &#8212; HTML5</title><style type="text/css">
   pre { margin-left: 2em; white-space: pre-wrap; }
   h2 { margin: 3em 0 1em 0; }
   h3 { margin: 2.5em 0 1em 0; }
   h4 { margin: 2.5em 0 0.75em 0; }
   h5, h6 { margin: 2.5em 0 1em; }
   h1 + h2, h1 + h2 + h2 { margin: 0.75em 0 0.75em; }
   h2 + h3, h3 + h4, h4 + h5, h5 + h6 { margin-top: 0.5em; }
   p { margin: 1em 0; }
   hr:not(.top) { display: block; background: none; border: none; padding: 0; margin: 2em 0; height: auto; }
   dl, dd { margin-top: 0; margin-bottom: 0; }
   dt { margin-top: 0.75em; margin-bottom: 0.25em; clear: left; }
   dt + dt { margin-top: 0; }
   dd dt { margin-top: 0.25em; margin-bottom: 0; }
   dd p { margin-top: 0; }
   dd dl + p { margin-top: 1em; }
   dd table + p { margin-top: 1em; }
   p + * > li, dd li { margin: 1em 0; }
   dt, dfn { font-weight: bold; font-style: normal; }
   i, em { font-style: italic; }
   dt dfn { font-style: italic; }
   pre, code { font-size: inherit; font-family: monospace; font-variant: normal; }
   pre strong { color: black; font: inherit; font-weight: bold; background: yellow; }
   pre em { font-weight: bolder; font-style: normal; }
   @media screen { code { color: orangered; } code :link, code :visited { color: inherit; } }
   var sub { vertical-align: bottom; font-size: smaller; position: relative; top: 0.1em; }
   table { border-collapse: collapse; border-style: hidden hidden none hidden; }
   table thead, table tbody { border-bottom: solid; }
   table tbody th:first-child { border-left: solid; }
   table tbody th { text-align: left; }
   table td, table th { border-left: solid; border-right: solid; border-bottom: solid thin; vertical-align: top; padding: 0.2em; }
   blockquote { margin: 0 0 0 2em; border: 0; padding: 0; font-style: italic; }

   .bad, .bad *:not(.XXX) { color: gray; border-color: gray; background: transparent; }
   .matrix, .matrix td { border: none; text-align: right; }
   .matrix { margin-left: 2em; }
   .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
   .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
   .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

   .toc dfn, h1 dfn, h2 dfn, h3 dfn, h4 dfn, h5 dfn, h6 dfn { font: inherit; }
   img.extra, p.overview { float: right; }
   pre.idl { border: solid thin; background: #EEEEEE; color: black; padding: 0.5em 1em; position: relative; }
   pre.idl :link, pre.idl :visited { color: inherit; background: transparent; }
   pre.idl::before { content: "IDL"; font: bold small sans-serif; padding: 0.5em; background: white; position: absolute; top: 0; margin: -1px 0 0 -4em; width: 1.5em; border: thin solid; border-radius: 0 0 0 0.5em }
   pre.css { border: solid thin; background: #FFFFEE; color: black; padding: 0.5em 1em; }
   pre.css:first-line { color: #AAAA50; }
   dl.domintro { color: green; margin: 2em 0 2em 2em; padding: 0.5em 1em; border: none; background: #DDFFDD; }
   hr + dl.domintro, div.impl + dl.domintro { margin-top: 2.5em; margin-bottom: 1.5em; }
   dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
   dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
   dl.domintro dd p { margin: 0.5em 0; }
   dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This box is non-normative. Implementation requirements are given below this box.'; color: black; font-style: italic; border: solid 2px; background: white; padding: 0 0.25em; }
   dl.switch { padding-left: 2em; }
   dl.switch > dt { text-indent: -1.5em; }
   dl.switch > dt:before { content: '\21AA'; padding: 0 0.5em 0 0; display: inline-block; width: 1em; text-align: right; line-height: 0.5em; }
   dl.triple { padding: 0 0 0 1em; }
   dl.triple dt, dl.triple dd { margin: 0; display: inline }
   dl.triple dt:after { content: ':'; }
   dl.triple dd:after { content: '\A'; white-space: pre; }
   .diff-old { text-decoration: line-through; color: silver; background: transparent; }
   .diff-chg, .diff-new { text-decoration: underline; color: green; background: transparent; }
   a .diff-new { border-bottom: 1px blue solid; }

   figure.diagrams { border: double black; background: white; padding: 1em; }
   figure.diagrams img { display: block; margin: 1em auto; } 

   h2 { page-break-before: always; }
   h1, h2, h3, h4, h5, h6 { page-break-after: avoid; }
   h1 + h2, hr + h2.no-toc { page-break-before: auto; }

   p  > span:not([title=""]):not([class="XXX"]):not([class="impl"]):not([class="note"]),
   li > span:not([title=""]):not([class="XXX"]):not([class="impl"]):not([class="note"]), { border-bottom: solid #9999CC; }

   div.head { margin: 0 0 1em; padding: 1em 0 0 0; }
   div.head p { margin: 0; }
   div.head h1 { margin: 0; }
   div.head .logo { float: right; margin: 0 1em; }
   div.head .logo img { border: none } /* remove border from top image */
   div.head dl { margin: 1em 0; }
   div.head p.copyright, div.head p.alt { font-size: x-small; font-style: oblique; margin: 0; }

   body > .toc > li { margin-top: 1em; margin-bottom: 1em; }
   body > .toc.brief > li { margin-top: 0.35em; margin-bottom: 0.35em; }
   body > .toc > li > * { margin-bottom: 0.5em; }
   body > .toc > li > * > li > * { margin-bottom: 0.25em; }
   .toc, .toc li { list-style: none; }

   .brief { margin-top: 1em; margin-bottom: 1em; line-height: 1.1; }
   .brief li { margin: 0; padding: 0; }
   .brief li p { margin: 0; padding: 0; }

   .category-list { margin-top: -0.75em; margin-bottom: 1em; line-height: 1.5; }
   .category-list::before { content: '\21D2\A0'; font-size: 1.2em; font-weight: 900; }
   .category-list li { display: inline; }
   .category-list li:not(:last-child)::after { content: ', '; }
   .category-list li > span, .category-list li > a { text-transform: lowercase; }
   .category-list li * { text-transform: none; } /* don't affect <code> nested in <a> */

   .XXX { color: #E50000; background: white; border: solid red; padding: 0.5em; margin: 1em 0; }
   .XXX > :first-child { margin-top: 0; }
   p .XXX { line-height: 3em; }
   .annotation { border: solid thin black; background: #0C479D; color: white; position: relative; margin: 8px 0 20px 0; }
   .annotation:before { position: absolute; left: 0; top: 0; width: 100%; height: 100%; margin: 6px -6px -6px 6px; background: #333333; z-index: -1; content: ''; }
   .annotation :link, .annotation :visited { color: inherit; }
   .annotation :link:hover, .annotation :visited:hover { background: transparent; }
   .annotation span { border: none ! important; }
   .note { color: green; background: transparent; font-family: sans-serif; }
   .warning { color: red; background: transparent; }
   .note, .warning { font-weight: bolder; font-style: italic; }
   .note em, .warning em, .note i, .warning i { font-style: normal; }
   p.note, div.note { padding: 0.5em 2em; }
   span.note { padding: 0 2em; }
   .note p:first-child, .warning p:first-child { margin-top: 0; }
   .note p:last-child, .warning p:last-child { margin-bottom: 0; }
   .warning:before { font-style: normal; }
   p.note:before { content: 'Note: '; }
   p.warning:before { content: '\26A0 Warning! '; }

   .bookkeeping:before { display: block; content: 'Bookkeeping details'; font-weight: bolder; font-style: italic; }
   .bookkeeping { font-size: 0.8em; margin: 2em 0; }
   .bookkeeping p { margin: 0.5em 2em; display: list-item; list-style: square; }
   .bookkeeping dt { margin: 0.5em 2em 0; }
   .bookkeeping dd { margin: 0 3em 0.5em; }

   h4 { position: relative; z-index: 3; }
   h4 + .element, h4 + div + .element { margin-top: -2.5em; padding-top: 2em; }
   .element {
     background: #EEEEFF;
     color: black;
     margin: 0 0 1em 0.15em;
     padding: 0 1em 0.25em 0.75em;
     border-left: solid #9999FF 0.25em;
     position: relative;
     z-index: 1;
   }
   .element:before {
     position: absolute;
     z-index: 2;
     top: 0;
     left: -1.15em;
     height: 2em;
     width: 0.9em;
     background: #EEEEFF;
     content: ' ';
     border-style: none none solid solid;
     border-color: #9999FF;
     border-width: 0.25em;
   }

   .example { display: block; color: #222222; background: #FCFCFC; border-left: double; margin-left: 2em; padding-left: 1em; }
   td > .example:only-child { margin: 0 0 0 0.1em; }

   ul.domTree, ul.domTree ul { padding: 0 0 0 1em; margin: 0; }
   ul.domTree li { padding: 0; margin: 0; list-style: none; position: relative; }
   ul.domTree li li { list-style: none; }
   ul.domTree li:first-child::before { position: absolute; top: 0; height: 0.6em; left: -0.75em; width: 0.5em; border-style: none none solid solid; content: ''; border-width: 0.1em; }
   ul.domTree li:not(:last-child)::after { position: absolute; top: 0; bottom: -0.6em; left: -0.75em; width: 0.5em; border-style: none none solid solid; content: ''; border-width: 0.1em; }
   ul.domTree span { font-style: italic; font-family: serif; }
   ul.domTree .t1 code { color: purple; font-weight: bold; }
   ul.domTree .t2 { font-style: normal; font-family: monospace; }
   ul.domTree .t2 .name { color: black; font-weight: bold; }
   ul.domTree .t2 .value { color: blue; font-weight: normal; }
   ul.domTree .t3 code, .domTree .t4 code, .domTree .t5 code { color: gray; }
   ul.domTree .t7 code, .domTree .t8 code { color: green; }
   ul.domTree .t10 code { color: teal; }

   body.dfnEnabled dfn { cursor: pointer; }
   .dfnPanel {
     display: inline;
     position: absolute;
     z-index: 10;
     height: auto;
     width: auto;
     padding: 0.5em 0.75em;
     font: small sans-serif, Droid Sans Fallback;
     background: #DDDDDD;
     color: black;
     border: outset 0.2em;
   }
   .dfnPanel * { margin: 0; padding: 0; font: inherit; text-indent: 0; }
   .dfnPanel :link, .dfnPanel :visited { color: black; }
   .dfnPanel p { font-weight: bolder; }
   .dfnPanel * + p { margin-top: 0.25em; }
   .dfnPanel li { list-style-position: inside; }

   #configUI { position: absolute; z-index: 20; top: 10em; right: 1em; width: 11em; font-size: small; }
   #configUI p { margin: 0.5em 0; padding: 0.3em; background: #EEEEEE; color: black; border: inset thin; }
   #configUI p label { display: block; }
   #configUI #updateUI, #configUI .loginUI { text-align: center; }
   #configUI input[type=button] { display: block; margin: auto; }

   fieldset { margin: 1em; padding: 0.5em 1em; }
   fieldset > legend + * { margin-top: 0; }
   fieldset > :last-child { margin-bottom: 0; }
   fieldset p { margin: 0.5em 0; }

   .stability {
     position: fixed;
     bottom: 0;
     left: 0; right: 0;
     margin: 0 auto 0 auto;
     width: 50%;
     background: maroon; color: yellow;
     -webkit-border-radius: 1em 1em 0 0;
     -moz-border-radius: 1em 1em 0 0;
     border-radius: 1em 1em 0 0;
     -moz-box-shadow: 0 0 1em #500;
     -webkit-box-shadow: 0 0 1em #500;
     box-shadow: 0 0 1em red;
     padding: 0.5em 1em;
     text-align: center;
   }
   .stability strong {
     display: block;
   }
   .stability input {
     appearance: none; margin: 0; border: 0; padding: 0.25em 0.5em; background: transparent; color: black;
     position: absolute; top: -0.5em; right: 0; font: 1.25em sans-serif; text-align: center;
   }
   .stability input:hover {
     color: white;
     text-shadow: 0 0 2px black;
   }
   .stability input:active {
     padding: 0.3em 0.45em 0.2em 0.55em;
   }
   .stability :link, .stability :visited,
   .stability :link:hover, .stability :visited:hover {
     background: transparent;
     color: white;
   }

  </style><link href="http://www.w3.org/StyleSheets/TR/W3C-WD" rel="stylesheet" type="text/css"><meta content="noindex" name="robots"><style type="text/css">

   .applies thead th > * { display: block; }
   .applies thead code { display: block; }
   .applies tbody th { whitespace: nowrap; }
   .applies td { text-align: center; }
   .applies .yes { background: yellow; }

   .matrix, .matrix td { border: hidden; text-align: right; }
   .matrix { margin-left: 2em; }

   .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
   .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
   .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

   td.eg { border-width: thin; text-align: center; }

   #table-example-1 { border: solid thin; border-collapse: collapse; margin-left: 3em; }
   #table-example-1 * { font-family: "Essays1743", serif; line-height: 1.01em; }
   #table-example-1 caption { padding-bottom: 0.5em; }
   #table-example-1 thead, #table-example-1 tbody { border: none; }
   #table-example-1 th, #table-example-1 td { border: solid thin; }
   #table-example-1 th { font-weight: normal; }
   #table-example-1 td { border-style: none solid; vertical-align: top; }
   #table-example-1 th { padding: 0.5em; vertical-align: middle; text-align: center; }
   #table-example-1 tbody tr:first-child td { padding-top: 0.5em; }
   #table-example-1 tbody tr:last-child td { padding-bottom: 1.5em; }
   #table-example-1 tbody td:first-child { padding-left: 2.5em; padding-right: 0; width: 9em; }
   #table-example-1 tbody td:first-child::after { content: leader(". "); }
   #table-example-1 tbody td { padding-left: 2em; padding-right: 2em; }
   #table-example-1 tbody td:first-child + td { width: 10em; }
   #table-example-1 tbody td:first-child + td ~ td { width: 2.5em; }
   #table-example-1 tbody td:first-child + td + td + td ~ td { width: 1.25em; }

   .apple-table-examples { border: none; border-collapse: separate; border-spacing: 1.5em 0em; width: 40em; margin-left: 3em; }
   .apple-table-examples * { font-family: "Times", serif; }
   .apple-table-examples td, .apple-table-examples th { border: none; white-space: nowrap; padding-top: 0; padding-bottom: 0; }
   .apple-table-examples tbody th:first-child { border-left: none; width: 100%; }
   .apple-table-examples thead th:first-child ~ th { font-size: smaller; font-weight: bolder; border-bottom: solid 2px; text-align: center; }
   .apple-table-examples tbody th::after, .apple-table-examples tfoot th::after { content: leader(". ") }
   .apple-table-examples tbody th, .apple-table-examples tfoot th { font: inherit; text-align: left; }
   .apple-table-examples td { text-align: right; vertical-align: top; }
   .apple-table-examples.e1 tbody tr:last-child td { border-bottom: solid 1px; }
   .apple-table-examples.e1 tbody + tbody tr:last-child td { border-bottom: double 3px; }
   .apple-table-examples.e2 th[scope=row] { padding-left: 1em; }
   .apple-table-examples sup { line-height: 0; }

   .details-example img { vertical-align: top; }

   #base64-table {
     white-space: nowrap;
     font-size: 0.6em;
     column-width: 6em;
     column-count: 5;
     column-gap: 1em;
     -moz-column-width: 6em;
     -moz-column-count: 5;
     -moz-column-gap: 1em;
     -webkit-column-width: 6em;
     -webkit-column-count: 5;
     -webkit-column-gap: 1em;
   }
   #base64-table thead { display: none; }
   #base64-table * { border: none; }
   #base64-table tbody td:first-child:after { content: ':'; }
   #base64-table tbody td:last-child { text-align: right; }

   #named-character-references-table {
     white-space: nowrap;
     font-size: 0.6em;
     column-width: 30em;
     column-gap: 1em;
     -moz-column-width: 30em;
     -moz-column-gap: 1em;
     -webkit-column-width: 30em;
     -webkit-column-gap: 1em;
   }
   #named-character-references-table > table > tbody > tr > td:first-child + td,
   #named-character-references-table > table > tbody > tr > td:last-child { text-align: center; }
   #named-character-references-table > table > tbody > tr > td:last-child:hover > span { position: absolute; top: auto; left: auto; margin-left: 0.5em; line-height: 1.2; font-size: 5em; border: outset; padding: 0.25em 0.5em; background: white; width: 1.25em; height: auto; text-align: center; }
   #named-character-references-table > table > tbody > tr#entity-CounterClockwiseContourIntegral > td:first-child { font-size: 0.5em; }

   .glyph.control { color: red; }

   @font-face {
     font-family: 'Essays1743';
     src: url('../fonts/Essays1743.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-weight: bold;
     src: url('../fonts/Essays1743-Bold.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-style: italic;
     src: url('../fonts/Essays1743-Italic.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-style: italic;
     font-weight: bold;
     src: url('../fonts/Essays1743-BoldItalic.ttf');
   }

  </style><link href="data:text/css," id="complete" rel="stylesheet" title="Complete specification"><link href="data:text/css,.impl%20%7B%20display:%20none;%20%7D%0Ahtml%20%7B%20border:%20solid%20yellow;%20%7D%20.domintro:before%20%7B%20display:%20none;%20%7D" id="author" rel="alternate stylesheet" title="Author documentation only"><link href="data:text/css,.impl%20%7B%20background:%20%23FFEEEE;%20%7D%20.domintro:before%20%7B%20background:%20%23FFEEEE;%20%7D" id="highlight" rel="alternate stylesheet" title="Highlight implementation requirements"><script>
   function getCookie(name) {
     var params = location.search.substr(1).split("&");
     for (var index = 0; index < params.length; index++) {
       if (params[index] == name)
         return "1";
       var data = params[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     var cookies = document.cookie.split("; ");
     for (var index = 0; index < cookies.length; index++) {
       var data = cookies[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     return null;
   }
  </script><link href="user-prompts.html" title="6.4 User prompts" rel="prev">
  <link href="index.html#contents" title="Table of contents" rel="contents">
  <link href="editing.html" title="7 User interaction" rel="next">
  </head><body onload="fixBrokenLink();" class="split chapter"><div class="head" id="head">
   <p><a href="http://www.w3.org/"><img alt="W3C" height="48" src="http://www.w3.org/Icons/w3c_home" width="72"></a></p>

   <h1>HTML5</h1>
   <h2 class="no-num no-toc" id="a-vocabulary-and-associated-apis-for-html-and-xhtml">A vocabulary and associated APIs for HTML and XHTML</h2>
   <h2 class="no-num no-toc" id="w3c-working-draft-11-october-2012">W3C Working Draft 11 October 2012</h2>
   </div>
   <div class="prev_next">
   <a href="user-prompts.html">&#8592; 6.4 User prompts</a> &#8211;
   <a href="index.html#contents">Table of contents</a> &#8211;
   <a href="editing.html">7 User interaction &#8594;</a>
  <ol class="toc"><li><ol><li><a href="system-state-and-capabilities.html#system-state-and-capabilities"><span class="secno">6.5 </span>System state and capabilities</a>
    <ol><li><a href="system-state-and-capabilities.html#the-navigator-object"><span class="secno">6.5.1 </span>The <code>Navigator</code> object</a>
      <ol><li><a href="system-state-and-capabilities.html#client-identification"><span class="secno">6.5.1.1 </span>Client identification</a></li><li><a href="system-state-and-capabilities.html#custom-handlers"><span class="secno">6.5.1.2 </span>Custom scheme and content handlers</a></li><li><a href="system-state-and-capabilities.html#security-and-privacy"><span class="secno">6.5.1.3 </span>Security and privacy</a></li><li><a href="system-state-and-capabilities.html#sample-handler-impl"><span class="secno">6.5.1.4 </span>Sample user interface</a></li><li><a href="system-state-and-capabilities.html#manually-releasing-the-storage-mutex"><span class="secno">6.5.1.5 </span>Manually releasing the storage mutex</a></li></ol></li><li><a href="system-state-and-capabilities.html#the-external-interface"><span class="secno">6.5.2 </span>The <code>External</code> interface</a></li></ol></li></ol></li></ol></div>

  <h3 id="system-state-and-capabilities"><span class="secno">6.5 </span>System state and capabilities</h3>

  <h4 id="the-navigator-object"><span class="secno">6.5.1 </span>The <code><a href="#navigator">Navigator</a></code> object</h4>

  <div class="impl">

  <p>The <dfn id="dom-navigator" title="dom-navigator"><code>navigator</code></dfn>
  attribute of the <code><a href="browsers.html#window">Window</a></code> interface must return an
  instance of the <code><a href="#navigator">Navigator</a></code> interface, which represents
  the identity and state of the user agent (the client), and allows
  Web pages to register themselves as potential protocol and content
  handlers:</p>

  </div>

  <pre class="idl">interface <dfn id="navigator">Navigator</dfn> {
  // objects implementing this interface also implement the interfaces given below
};
<a href="#navigator">Navigator</a> implements <a href="#navigatorid">NavigatorID</a>;
<a href="#navigator">Navigator</a> implements <a href="offline.html#navigatoronline">NavigatorOnLine</a>;
<a href="#navigator">Navigator</a> implements <a href="#navigatorcontentutils">NavigatorContentUtils</a>;
<a href="#navigator">Navigator</a> implements <a href="#navigatorstorageutils">NavigatorStorageUtils</a>;</pre>

<!-- v2:
  cookieEnabled geolocator javaEnabled mozIsLocallyAvailable preference
  readonly attribute <span>MimeTypeArray</span> <span title="dom-navigator-mimeTypes">mimeTypes</span>;
  readonly attribute <span>PluginArray</span> <span title="dom-navigator-plugins">plugins</span>;
  (the latter is used in a <video> element demo now, so we might need to pull this forward from v2!)
-->

  <div class="impl">

  <p>These interfaces are defined separately so that other
  specifications can re-use parts of the <code><a href="#navigator">Navigator</a></code>
  interface.</p>

   <!-- v2: also, could expose languages:
   <dt><dfn title="dom-navigator-browserLanguage"><code>browserLanguage</code></dfn></dt> <!- - Opera and IE only - ->
   <dd><p>Must return either null or a language tag representing the language the browser uses in its interface.</p></dd>
   <dt><dfn title="dom-navigator-userLanguage"><code>userLanguage</code></dfn></dt> <!- - Opera and IE only - ->
   <dt><dfn title="dom-navigator-language"><code>language</code></dfn></dt> <!- - Opera, Safari, and Mozilla only - ->
   <dd><p>Must return either null or a language tag representing the user's preferred language.</p></dd>
   -->

  </div>


  <h5 id="client-identification"><span class="secno">6.5.1.1 </span>Client identification</h5>

  <pre class="idl">[NoInterfaceObject]
interface <dfn id="navigatorid">NavigatorID</dfn> {<!--
  readonly attribute DOMString <span title="dom-navigator-appCodeName">appCodeName</span>;-->
  readonly attribute DOMString <a href="#dom-navigator-appname" title="dom-navigator-appName">appName</a>;
  readonly attribute DOMString <a href="#dom-navigator-appversion" title="dom-navigator-appVersion">appVersion</a>;
  readonly attribute DOMString <a href="#dom-navigator-platform" title="dom-navigator-platform">platform</a>;
  readonly attribute DOMString <a href="#dom-navigator-useragent" title="dom-navigator-userAgent">userAgent</a>;
};</pre>

  <p>In certain cases, despite the best efforts of the entire
  industry, Web browsers have bugs and limitations that Web authors
  are forced to work around.</p>

  <p>This section defines a collection of attributes that can be used
  to determine, from script, the kind of user agent in use, in order
  to work around these issues.</p>

  <p>Client detection should always be limited to detecting known
  current versions; future versions and unknown versions should always
  be assumed to be fully compliant.</p>

  <dl class="domintro"><dt><var title="">window</var> . <code title="dom-navigator"><a href="#dom-navigator">navigator</a></code> . <code title="dom-navigator-appName"><a href="#dom-navigator-appname">appName</a></code></dt>
   <dd>
    <p>Returns the name of the browser.</p>
   </dd>

   <dt><var title="">window</var> . <code title="dom-navigator"><a href="#dom-navigator">navigator</a></code> . <code title="dom-navigator-appVersion"><a href="#dom-navigator-appversion">appVersion</a></code></dt>
   <dd>
    <p>Returns the version of the browser.</p>
   </dd>

   <dt><var title="">window</var> . <code title="dom-navigator"><a href="#dom-navigator">navigator</a></code> . <code title="dom-navigator-platform"><a href="#dom-navigator-platform">platform</a></code></dt>
   <dd>
    <p>Returns the name of the platform.</p>
   </dd>

   <dt><var title="">window</var> . <code title="dom-navigator"><a href="#dom-navigator">navigator</a></code> . <code title="dom-navigator-userAgent"><a href="#dom-navigator-useragent">userAgent</a></code></dt>
   <dd>
    <p>Returns the complete User-Agent header.</p>
   </dd>

  </dl><div class="impl">

  <dl><!-- redundant
   <dt><dfn title="dom-navigator-appCodeName"><code>appCodeName</code></dfn></dt>
   <dd><p>Must return the string "<code title="">Mozilla</code>".</p></dd>
   --><!-- appMinorVersion: IE only. In IE8b1, returns " Beta" (with the space) --><dt><dfn id="dom-navigator-appname" title="dom-navigator-appName"><code>appName</code></dfn></dt>
   <dd><p>Must return either the string "<code title="">Netscape</code>" or the full name of the browser, e.g. "<code title="">Mellblom Browsernator</code>".</p></dd>

   <dt><dfn id="dom-navigator-appversion" title="dom-navigator-appVersion"><code>appVersion</code></dfn></dt>
   <dd><p>Must return either the string "<code title="">4.0</code>" or a string representing the version of the browser in detail, e.g. "<code title="">1.0 (VMS; en-US) Mellblomenator/9000</code>".</p></dd>

   <!-- buildID: Mozilla only -->

   <!-- oscpu: Mozilla only -->

   <dt><dfn id="dom-navigator-platform" title="dom-navigator-platform"><code>platform</code></dfn></dt>
   <dd><p>Must return either the empty string or a string representing the platform on which the browser is executing, e.g. "<code title="">MacIntel</code>", "<code title="">Win32</code>", "<code title="">FreeBSD i386</code>", "<code title="">WebTV OS</code>".</p></dd>

   <!-- product: Mozilla and Safari only; always returns "Gecko" -->

   <!-- productSub: Mozilla and Safari only; returns same as buildID in Mozilla, and returns the fixed string "20030107" in Safari -->

   <!-- securityPolicy: Mozilla only; always returns "" -->

   <!-- taintEnabled(): Opera, IE and Mozilla have this function as one that always returns false -->

   <dt><dfn id="dom-navigator-useragent" title="dom-navigator-userAgent"><code>userAgent</code></dfn></dt>
   <dd><p>Must return the string used for the value of the "<code title="">User-Agent</code>" header in HTTP requests, or the empty string if no such header is ever sent.</p></dd>

   <!-- vendor: Mozilla and Safari only; always returns "" in Mozilla, and returns the fixed string "Apple Computer, Inc." in Safari -->

   <!-- vendorSub: Mozilla and Safari only; always returns "" -->

  </dl><p class="warning">Any information in this API that varies from user
  to user can be used to profile the user. In fact, if enough such
  information is available, a user can actually be uniquely
  identified. For this reason, user agent implementors are strongly
  urged to include as little information in this API as possible.
  <!--INSERT FINGERPRINT-->
  </p>

  </div>


  <h5 id="custom-handlers"><span class="secno">6.5.1.2 </span>Custom scheme and content handlers</h5>

  <pre class="idl">[NoInterfaceObject]
interface <dfn id="navigatorcontentutils">NavigatorContentUtils</dfn> {
  // content handler registration
  void <a href="#dom-navigator-registerprotocolhandler" title="dom-navigator-registerProtocolHandler">registerProtocolHandler</a>(DOMString scheme, DOMString url, DOMString title);
  void <a href="#dom-navigator-registercontenthandler" title="dom-navigator-registerContentHandler">registerContentHandler</a>(DOMString mimeType, DOMString url, DOMString title);
  DOMString <a href="#dom-navigator-isprotocolhandlerregistered" title="dom-navigator-isProtocolHandlerRegistered">isProtocolHandlerRegistered</a>(DOMString scheme, DOMString url);
  DOMString <a href="#dom-navigator-iscontenthandlerregistered" title="dom-navigator-isContentHandlerRegistered">isContentHandlerRegistered</a>(DOMString mimeType, DOMString url);
  void <a href="#dom-navigator-unregisterprotocolhandler" title="dom-navigator-unregisterProtocolHandler">unregisterProtocolHandler</a>(DOMString scheme, DOMString url);
  void <a href="#dom-navigator-unregistercontenthandler" title="dom-navigator-unregisterContentHandler">unregisterContentHandler</a>(DOMString mimeType, DOMString url);
};</pre>

  <p>The <dfn id="dom-navigator-registerprotocolhandler" title="dom-navigator-registerProtocolHandler"><code>registerProtocolHandler()</code></dfn>
  method allows Web sites to register themselves as possible handlers
  for particular schemes. For example, an online telephone messaging
  service could register itself as a handler of the <code>sms:</code>
  scheme, so that if the user clicks on such a link, he is given the
  opportunity to use that Web site. Analogously, the <dfn id="dom-navigator-registercontenthandler" title="dom-navigator-registerContentHandler"><code>registerContentHandler()</code></dfn>
  method allows Web sites to register themselves as possible handlers
  for content in a particular <a href="infrastructure.html#mime-type">MIME type</a>. For example, the
  same online telephone messaging service could register itself as a
  handler for <code>text/vcard</code> files, so that if the user has
  no native application capable of handling vCards, his Web browser
  can instead suggest he use that site to view contact information
  stored on vCards that he opens. <a href="references.html#refsRFC5724">[RFC5724]</a>
  <a href="references.html#refsRFC6350">RFC6350</a></p>

  <dl class="domintro"><dt><var title="">window</var> . <code title="dom-navigator"><a href="#dom-navigator">navigator</a></code> . <code title="dom-navigator-registerProtocolHandler"><a href="#dom-navigator-registerprotocolhandler">registerProtocolHandler</a></code>(<var title="">scheme</var>, <var title="">url</var>, <var title="">title</var>)</dt>
   <dt><var title="">window</var> . <code title="dom-navigator"><a href="#dom-navigator">navigator</a></code> . <code title="dom-navigator-registerContentHandler"><a href="#dom-navigator-registercontenthandler">registerContentHandler</a></code>(<var title="">mimeType</var>, <var title="">url</var>, <var title="">title</var>)</dt>

   <dd>

    <p>Registers a handler for the given scheme or content type, at
    the given URL, with the given title.</p>

    <p>The string "<code title="">%s</code>" in the URL is used as a
    placeholder for where to put the URL of the content to be
    handled.</p>

    <p>Throws a <code><a href="infrastructure.html#securityerror">SecurityError</a></code> exception if the user agent
    blocks the registration (this might happen if trying to register
    as a handler for "http", for instance).</p>

    <p>Throws a <code><a href="infrastructure.html#syntaxerror">SyntaxError</a></code> if the "<code title="">%s</code>" string is missing in the URL.</p>

   </dd>

  </dl><div class="impl">

  <p>User agents may, within the constraints described in this
  section, do whatever they like when the methods are called. A UA
  could, for instance, prompt the user and offer the user the
  opportunity to add the site to a shortlist of handlers, or make the
  handlers his default, or cancel the request. UAs could provide such
  a UI through modal UI or through a non-modal transient notification
  interface. UAs could also simply silently collect the information,
  providing it only when relevant to the user.</p>

  <p>User agents should keep track of which sites have registered
  handlers (even if the user has declined such registrations) so that
  the user is not repeatedly prompted with the same request.</p>

  <p>The arguments to the methods have the following meanings and
  corresponding implementation requirements. The requirements that
  involve throwing exceptions must be processed in the order given
  below, stopping at the first exception thrown. (So the exceptions
  for the first argument take precedence over the exceptions for the
  second argument.)</p>

  <dl><dt><var title="">scheme</var> (<code title="dom-navigator-registerProtocolHandler"><a href="#dom-navigator-registerprotocolhandler">registerProtocolHandler()</a></code> only)</dt>

   <dd>

    <p>A scheme, such as <code>mailto</code> or <code>web+auth</code>.
    The scheme must be compared in an <a href="infrastructure.html#ascii-case-insensitive">ASCII
    case-insensitive</a> manner by user agents for the purposes of
    comparing with the scheme part of URLs that they consider against
    the list of registered handlers.</p>

    <p>The <var title="">scheme</var> value, if it contains a colon
    (as in "<code>mailto:</code>"), will never match anything, since
    schemes don't contain colons.</p>

    <p>If the <code title="dom-navigator-registerProtocolHandler"><a href="#dom-navigator-registerprotocolhandler">registerProtocolHandler()</a></code>
    method is invoked with a scheme that is neither a
    <a href="#whitelisted-scheme">whitelisted scheme</a> nor a scheme whose value starts
    with the substring "<code title="">web+</code>" and otherwise
    contains only characters in the range <a href="common-microsyntaxes.html#lowercase-ascii-letters">lowercase ASCII letters</a>, the user agent must throw a
    <code><a href="infrastructure.html#securityerror">SecurityError</a></code> exception.</p>

    <p>The following schemes are the <dfn id="whitelisted-scheme" title="whitelisted
    scheme">whitelisted schemes</dfn>:</p>

    <ul class="brief"><li><code title="">irc</code></li>
     <li><code title="">mailto</code></li>
     <li><code title="">magnet</code></li>
     <li><code title="">mms</code></li>
     <li><code title="">news</code></li>
     <li><code title="">nntp</code></li>
     <li><code title="">sip</code></li>
     <li><code title="">sms</code></li>
     <li><code title="">smsto</code></li>
     <li><code title="">ssh</code></li>
     <li><code title="">tel</code></li>
     <li><code title="">urn</code></li>
     <li><code title="">webcal</code></li>
     <li><code title="">xmpp</code></li>
    </ul><p class="note">This list can be changed. If there are schemes
    that should be added, please send feedback.</p>

    <p class="note">This list excludes any schemes that could
    reasonably be expected to be supported inline, e.g. in an
    <code><a href="the-iframe-element.html#the-iframe-element">iframe</a></code>, such as <code title="">http</code> or (more
    theoretically) <code title="">gopher</code>. If those were
    supported, they could potentially be used in man-in-the-middle
    attacks, by replacing pages that have frames with such content
    with content under the control of the protocol handler. If the
    user agent has native support for the schemes, this could further
    be used for cookie-theft attacks.</p>

   </dd>

   <dt><var title="">mimeType</var> (<code title="dom-navigator-registerContentHandler"><a href="#dom-navigator-registercontenthandler">registerContentHandler()</a></code> only)</dt>

   <dd>

    <p>A <a href="infrastructure.html#mime-type">MIME type</a>, such as
    <code>model/vnd.flatland.3dml</code> or
    <code>application/vnd.google-earth.kml+xml</code>. The <a href="infrastructure.html#mime-type">MIME
    type</a> must be compared in an <a href="infrastructure.html#ascii-case-insensitive">ASCII
    case-insensitive</a> manner by user agents for the purposes of
    comparing with MIME types of documents that they consider against
    the list of registered handlers.</p>

    <p>User agents must compare the given values only to the MIME
    type/subtype parts of content types, not to the complete type
    including parameters. Thus, if <var title="">mimeType</var> values
    passed to this method include characters such as commas or
    whitespace, or include MIME parameters, then the handler being
    registered will never be used.</p>

    <p class="note">The type is compared to the <a href="infrastructure.html#mime-type">MIME type</a>
    used by the user agent <em>after</em> the sniffing algorithms have
    been applied.</p>

    <p>If the <code title="dom-navigator-registerContentHandler"><a href="#dom-navigator-registercontenthandler">registerContentHandler()</a></code>
    method is invoked with a <a href="infrastructure.html#mime-type">MIME type</a> that is in the
    <a href="#type-blacklist">type blacklist</a> or that the user agent has deemed a
    privileged type, the user agent must throw a
    <code><a href="infrastructure.html#securityerror">SecurityError</a></code> exception.</p>

    <p>The following <a href="infrastructure.html#mime-type" title="MIME type">MIME types</a> are in
    the <dfn id="type-blacklist">type blacklist</dfn>:</p>

    <ul class="brief"><li><code><a href="iana.html#application/x-www-form-urlencoded">application/x-www-form-urlencoded</a></code></li>
     <li><code><a href="iana.html#application/xhtml+xml">application/xhtml+xml</a></code></li>
     <li><code>application/xml</code></li>
     <li><code>image/gif</code></li>
     <li><code>image/jpeg</code></li>
     <li><code>image/png</code></li>
     <li><code>image/svg+xml</code></li>
     <li><code><a href="iana.html#multipart/x-mixed-replace">multipart/x-mixed-replace</a></code></li>
     <li><code><a href="iana.html#text/cache-manifest">text/cache-manifest</a></code></li>
     <li><code>text/css</code></li>
     <li><code><a href="iana.html#text/html">text/html</a></code></li>
     <li><code>text/ping</code></li>
     <li><code>text/plain</code></li>
     <li><code>text/xml</code></li>
     <li>All types that the user agent supports displaying natively in a <a href="browsers.html#browsing-context">browsing context</a> during <a href="history.html#navigate" title="navigate">navigation</a>, except for <code>application/rss+xml</code> and <code>application/atom+xml</code></li>

    </ul><p class="note">This list can be changed. If there are schemes
    that should be added, please send feedback.</p>

   </dd>


   <dt><var title="">url</var></dt>

   <dd>

    <p>A string used to build the <a href="urls.html#url">URL</a> of the page that
    will handle the requests.</p>

    <p>User agents must throw a <code><a href="infrastructure.html#syntaxerror">SyntaxError</a></code> exception if
    the <var title="">url</var> argument passed to one of these
    methods does not contain the exact literal string
    "<code><a href="the-s-element.html#the-s-element">%s</a></code>".</p>

    <p>User agents must throw a <code><a href="infrastructure.html#syntaxerror">SyntaxError</a></code> if <a href="urls.html#resolve-a-url" title="resolve a url">resolving</a> the <var title="">url</var>
    argument relative to the <a href="browsers.html#entry-script">entry script</a>'s <a href="webappapis.html#script's-base-url" title="script's base URL">base URL</a>, is not successful.</p>

    <p class="note">The resulting <a href="urls.html#absolute-url">absolute URL</a> would by
    definition not be a <a href="urls.html#valid-url">valid URL</a> as it would include the
    string "<code title="">%s</code>" which is not a valid component
    in a URL.</p>

    <p>User agents must throw a <code><a href="infrastructure.html#securityerror">SecurityError</a></code> exception if
    the resulting <a href="urls.html#absolute-url">absolute URL</a> has an <a href="browsers.html#origin-0">origin</a>
    that differs from the <a href="browsers.html#origin-0">origin</a> of the <a href="browsers.html#entry-script">entry
    script</a>.</p>

    <p class="note">This is forcibly the case if the <code title="">%s</code> placeholder is in the scheme, host, or port
    parts of the URL.</p>

    <p>The resulting <a href="urls.html#absolute-url">absolute URL</a> is the
    <dfn id="proto-url">proto-URL</dfn>. It identifies the handler for the purposes
    of the methods described below.</p>

    <p>When the user agent uses this handler, it must replace the
    first occurrence of the exact literal string "<code title="">%s</code>" in the <var title="">url</var> argument with
    an escaped version of the <a href="urls.html#absolute-url">absolute URL</a> of the content
    in question (as defined below), then <a href="urls.html#resolve-a-url" title="resolve a
    url">resolve</a> the resulting URL, relative to the <a href="webappapis.html#script's-base-url" title="script's base URL">base URL</a> of the <a href="browsers.html#entry-script">entry
    script</a> at the time the <code title="dom-navigator-registerContentHandler"><a href="#dom-navigator-registercontenthandler">registerContentHandler()</a></code>
    or <code title="dom-navigator-registerProtocolHandler"><a href="#dom-navigator-registerprotocolhandler">registerProtocolHandler()</a></code>
    methods were invoked, and then <a href="history.html#navigate">navigate</a><!--DONAV
    user--> an appropriate <a href="browsers.html#browsing-context">browsing context</a> to the
    resulting URL using the GET method (<a href="urls.html#concept-http-equivalent-get" title="concept-http-equivalent-get">or equivalent</a> for
    non-HTTP URLs).</p>

    <p>To get the escaped version of the <a href="urls.html#absolute-url">absolute URL</a> of
    the content in question, the user agent must replace every
    character in that <a href="urls.html#absolute-url">absolute URL</a> that doesn't match the
    &lt;query&gt; production defined in RFC 3986 by the
    percent-encoded form of that character. <a href="references.html#refsRFC3986">[RFC3986]</a></p>

    <div class="example">

     <p>If the user had visited a site at <code title="">http://example.com/</code> that made the following
     call:</p>

     <pre>navigator.registerContentHandler('application/x-soup', 'soup?url=%s', 'SoupWeb&#8482;')</pre>

     <p>...and then, much later, while visiting <code title="">http://www.example.net/</code>, clicked on a link such
     as:</p>

     <pre>&lt;a href="chickenk&#239;wi.soup"&gt;Download our Chicken K&#239;wi soup!&lt;/a&gt;</pre>

     <p>...then, assuming this <code>chickenk&#239;wi.soup</code> file
     was served with the <a href="infrastructure.html#mime-type">MIME type</a>
     <code>application/x-soup</code>, the UA might navigate to the
     following URL:</p>

     <pre>http://example.com/soup?url=http://www.example.net/chickenk%C3%AFwi.soup</pre>

     <p>This site could then fetch the <code>chickenk&#239;wi.soup</code>
     file and do whatever it is that it does with soup (synthesize it
     and ship it to the user, or whatever).</p>

    </div>

   </dd>

   <dt><var title="">title</var></dt>

   <dd>

    <p>A descriptive title of the handler, which the UA might use to
    remind the user what the site in question is.</p>

   </dd>

  </dl><p>This section does not define how the pages registered by these
  methods are used, beyond the requirements on how to process the <var title="">url</var> value (see above). To some extent, the <a href="history.html#navigate" title="navigate">processing model for navigating across
  documents</a> defines some cases where these methods are
  relevant, but in general UAs may use this information wherever they
  would otherwise consider handing content to native plugins or helper
  applications.</p>

  <p>UAs must not use registered content handlers to handle content
  that was returned as part of a non-GET transaction (or rather, as
  part of any non-idempotent transaction), as the remote site would
  not be able to fetch the same data.</p>

  <hr></div>

  <p>In addition to the registration methods, there are also methods
  for determining if particular handlers have been registered, and for
  unregistering handlers.</p>

  <dl class="domintro"><dt><var title="">state</var> = <var title="">window</var> . <code title="dom-navigator"><a href="#dom-navigator">navigator</a></code> . <code title="dom-navigator-isProtocolHandlerRegistered"><a href="#dom-navigator-isprotocolhandlerregistered">isProtocolHandlerRegistered</a></code>(<var title="">scheme</var>, <var title="">url</var>)</dt>
   <dt><var title="">state</var> = <var title="">window</var> . <code title="dom-navigator"><a href="#dom-navigator">navigator</a></code> . <code title="dom-navigator-isContentHandlerRegistered"><a href="#dom-navigator-iscontenthandlerregistered">isContentHandlerRegistered</a></code>(<var title="">mimeType</var>, <var title="">url</var>)</dt>

   <dd>

    <p>Returns one of the following strings describing the state of
    the handler given by the arguments:</p>

    <dl><dt><code title="">new</code>
     </dt><dd>Indicates that no attempt has been made to register the given
     handler (or that the handler has been unregistered). It would be
     appropriate to promote the availability of the handler or to just
     automatically register the handler.

     </dd><dt><code title="">registered</code>
     </dt><dd>Indicates that the given handler has been registered or that
     the site is blocked from registering the handler. Trying to
     register the handler again would have no effect.

     </dd><dt><code title="">declined</code>
     </dt><dd>Indicates that the given handler has been offered but was
     rejected. Trying to register the handler again may prompt the
     user again.

    </dd></dl></dd>

   <dt><var title="">state</var> = <var title="">window</var> . <code title="dom-navigator"><a href="#dom-navigator">navigator</a></code> . <code title="dom-navigator-unregisterProtocolHandler"><a href="#dom-navigator-unregisterprotocolhandler">unregisterProtocolHandler</a></code>(<var title="">scheme</var>, <var title="">url</var>)</dt>
   <dt><var title="">state</var> = <var title="">window</var> . <code title="dom-navigator"><a href="#dom-navigator">navigator</a></code> . <code title="dom-navigator-unregisterContentHandler"><a href="#dom-navigator-unregistercontenthandler">unregisterContentHandler</a></code>(<var title="">mimeType</var>, <var title="">url</var>)</dt>

   <dd>

    <p>Unregisters the handler given by the arguments.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-navigator-isprotocolhandlerregistered" title="dom-navigator-isProtocolHandlerRegistered"><code>isProtocolHandlerRegistered()</code></dfn>
  method must return the <a href="#handler-state-string">handler state string</a> that most
  closely describes the current state of the handler described by the
  two arguments to the method, where the first argument gives the
  scheme and the second gives the string used to build the
  <a href="urls.html#url">URL</a> of the page that will handle the requests.
  <!--INSERT FINGERPRINT-->
  </p>

  <p>The first argument must be compared to the schemes for which
  custom protocol handlers are registered in an <a href="infrastructure.html#ascii-case-insensitive">ASCII
  case-insensitive</a> manner to find the relevant handlers.</p>

  <p>The second argument must be preprocessed as described below, and
  if that is successful, must then be matched against the <a href="#proto-url" title="proto-URL">proto-URLs</a> of the relevant handlers to find
  the described handler.</p>

  <hr><p>The <dfn id="dom-navigator-iscontenthandlerregistered" title="dom-navigator-isContentHandlerRegistered"><code>isContentHandlerRegistered()</code></dfn>
  method must return the <a href="#handler-state-string">handler state string</a> that most
  closely describes the current state of the handler described by the
  two arguments to the method, where the first argument gives the
  <a href="infrastructure.html#mime-type">MIME type</a> and the second gives the string used to build
  the <a href="urls.html#url">URL</a> of the page that will handle the requests.
  <!--INSERT FINGERPRINT-->
  </p>

  <p>The first argument must be compared to the <a href="infrastructure.html#mime-type" title="MIME
  type">MIME types</a> for which custom content handlers are
  registered in an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> manner to find
  the relevant handlers.</p>

  <p>The second argument must be preprocessed as described below, and
  if that is successful, must then be matched against the
  <a href="#proto-url" title="proto-URL">proto-URLs</a> of the relevant handlers to
  find the described handler.</p>

  <hr><p>The <dfn id="handler-state-string" title="handler state string">handler state strings</dfn>
  are the following strings. Each string describes several situations,
  as given by the following list.</p>

  <dl><dt><code title="">new</code>

   </dt><dd>The described handler has never been registered for the given
   scheme or type.

   <dd>The described handler was once registered for the given scheme
   or type, but the site has since unregistered it. If the handler
   were to be reregistered, the user would be notified accordingly.

   <dd>The described handler was once registered for the given scheme
   or type, but the site has since unregistered it, but the user has
   indicated that the site is to be blocked from registering the type
   again, so the user agent would ignore further registration attempts.


   </dd></dd></dd><dt><code title="">registered</code>

   </dt><dd>An attempt was made to register the described handler for the
   given scheme or type, but the user has not yet been notified, and
   the user agent would ignore further registration attempts. (Maybe
   the user agent batches registration requests to display them when
   the user requests to be notified about them, and the user has not
   yet requested that the user agent notify it of the previous
   registration attempt.)

   <dd>The described handler is registered for the given scheme or
   type (maybe, or maybe not, as the default handler).

   <dd>The described handler is permanently blocked from being
   (re)registered. (Maybe the user marked the registration attempt as
   spam, or blocked the site for other reasons.)


   </dd></dd></dd><dt><code title="">declined</code>

   </dt><dd>An attempt was made to register the described handler for the
   given scheme or type, but the user has not yet been notified;
   however, the user might be notified if another registration attempt
   were to be made. (Maybe the last registration attempt was made
   while the page was in the background and the user closed the page
   without looking at it, and the user agent requires confirmation for
   this registration attempt.)

   <dd>An attempt was made to register the described handler for the
   given scheme or type, but the user has not yet responded.

   <dd>An attempt was made to register the described handler for the
   given scheme or type, but the user declined the offer. The user has
   not indicated that the handler is to be permanently blocked,
   however, so another attempt to register the described handler might
   result in the user being prompted again.

   <dd>The described handler was once registered for the given scheme
   or type, but the user has since removed it. The user has not
   indicated that the handler is to be permanently blocked, however,
   so another attempt to register the described handler might result
   in the user being prompted again.

  </dd></dd></dd></dd></dl><hr><p>The <dfn id="dom-navigator-unregisterprotocolhandler" title="dom-navigator-unregisterProtocolHandler"><code>unregisterProtocolHandler()</code></dfn>
  method must unregister the handler described by the two arguments to
  the method, where the first argument gives the scheme and the second
  gives the string used to build the <a href="urls.html#url">URL</a> of the page that
  will handle the requests.</p>

  <p>The first argument must be compared to the schemes for which
  custom protocol handlers are registered in an <a href="infrastructure.html#ascii-case-insensitive">ASCII
  case-insensitive</a> manner to find the relevant handlers.</p>

  <p>The second argument must be preprocessed as described below, and
  if that is successful, must then be matched against the <a href="#proto-url" title="proto-URL">proto-URLs</a> of the relevant handlers to find
  the described handler.</p>

  <hr><p>The <dfn id="dom-navigator-unregistercontenthandler" title="dom-navigator-unregisterContentHandler"><code>unregisterContentHandler()</code></dfn>
  method must unregister the handler described by the two arguments to
  the method, where the first argument gives the <a href="infrastructure.html#mime-type">MIME
  type</a> and the second gives the string used to build the
  <a href="urls.html#url">URL</a> of the page that will handle the requests.</p>

  <p>The first argument must be compared to the <a href="infrastructure.html#mime-type" title="MIME
  type">MIME types</a> for which custom content handlers are
  registered in an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> manner to find
  the relevant handlers.</p>

  <p>The second argument must be preprocessed as described below, and
  if that is successful, must then be matched against the
  <a href="#proto-url" title="proto-URL">proto-URLs</a> of the relevant handlers to
  find the described handler.</p>

  <hr><p>The second argument of the four methods described above must be
  preprocessed as follows:</p>

  <ol><li><p>If the string does not contain the substring "<code title="">%s</code>", abort these steps. There's no matching
   handler.</p></li>

   <li><p><a href="urls.html#resolve-a-url" title="resolve a URL">Resolve</a> the string
   relative to the <a href="webappapis.html#script's-base-url" title="script's base URL">base URL</a> of
   the <a href="browsers.html#entry-script">entry script</a>.</p></li>

   <li><p>If this fails, then throw a <code><a href="infrastructure.html#syntaxerror">SyntaxError</a></code>
   exception, aborting the method.</p></li>

   <li><p>If the resoluting <a href="urls.html#absolute-url">absolute URL</a>'s
   <a href="browsers.html#origin-0">origin</a> is not the <a href="browsers.html#same-origin">same origin</a> as that of
   the <a href="browsers.html#entry-script">entry script</a> throw a <a href="infrastructure.html#securityerror">SecurityError</a>
   exception, aborting the method.</p></li>

   <li><p>Return the resulting <a href="urls.html#absolute-url">absolute URL</a> as the result
   of preprocessing the argument.</p></li>

  </ol></div>



<!--ADD-TOPIC:Security-->
  <div class="impl">

  <h5 id="security-and-privacy"><span class="secno">6.5.1.3 </span>Security and privacy</h5>

  <p>These mechanisms can introduce a number of concerns, in
  particular privacy concerns.</p>

  <p><strong>Hijacking all Web usage.</strong> User agents should not
  allow schemes that are key to its normal operation, such as
  <code>http</code> or <code>https</code>, to be rerouted through
  third-party sites. This would allow a user's activities to be
  trivially tracked, and would allow user information, even in secure
  connections, to be collected.</p>

  <p><strong>Hijacking defaults.</strong> It is strongly recommended
  that user agents do not automatically change any defaults, as this
  could lead the user to send data to remote hosts that the user is
  not expecting. New handlers registering themselves should never
  automatically cause those sites to be used.</p>

  <p><strong>Registration spamming.</strong> User agents should
  consider the possibility that a site will attempt to register a
  large number of handlers, possibly from multiple domains (e.g. by
  redirecting through a series of pages each on a different domain,
  and each registering a handler for <code>video/mpeg</code> &#8212;
  analogous practices abusing other Web browser features have been
  used by pornography Web sites for many years). User agents should
  gracefully handle such hostile attempts, protecting the user.</p>

  <p><strong>Misleading titles.</strong> User agents should not rely
  wholly on the <var title="">title</var> argument to the methods when
  presenting the registered handlers to the user, since sites could
  easily lie. For example, a site <code>hostile.example.net</code>
  could claim that it was registering the "Cuddly Bear Happy Content
  Handler". User agents should therefore use the handler's domain in
  any UI along with any title.</p>

  <p><strong>Hostile handler metadata.</strong> User agents should
  protect against typical attacks against strings embedded in their
  interface, for example ensuring that markup or escape characters in
  such strings are not executed, that null bytes are properly handled,
  that over-long strings do not cause crashes or buffer overruns, and
  so forth.</p>

  <p><strong>Leaking Intranet URLs.</strong> The mechanism described
  in this section can result in secret Intranet URLs being leaked, in
  the following manner:</p>

  <ol><li>The user registers a third-party content handler as the default
   handler for a content type.</li>

   <li>The user then browses his corporate Intranet site and accesses
   a document that uses that content type.</li>

   <li>The user agent contacts the third party and hands the third
   party the URL to the Intranet content.</li>

  </ol><p>No actual confidential file data is leaked in this manner, but
  the URLs themselves could contain confidential information. For
  example, the URL could be
  <code>http://www.corp.example.com/upcoming-aquisitions/the-sample-company.egf</code>,
  which might tell the third party that Example Corporation is
  intending to merge with The Sample Company. Implementors might wish
  to consider allowing administrators to disable this feature for
  certain subdomains, content types, or schemes.</p>

  <p><strong>Leaking secure URLs.</strong> User agents should not send
  HTTPS URLs to third-party sites registered as content handlers
  without the user's informed consent, for the same reason that user
  agents sometimes avoid sending <code title="http-referer">Referer</code> (sic) HTTP headers from secure
  sites to third-party sites.</p>

  <p><strong>Leaking credentials.</strong> User agents must never send
  username or password information in the URLs that are escaped and
  included sent to the handler sites. User agents may even avoid
  attempting to pass to Web-based handlers the URLs of resources
  that are known to require authentication to access, as such sites
  would be unable to access the resources in question without
  prompting the user for credentials themselves (a practice that would
  require the user to know whether to trust the third-party handler, a
  decision many users are unable to make or even understand).</p>

  </div>
<!--REMOVE-TOPIC:Security-->


  <div class="impl">

  <h5 id="sample-handler-impl"><span class="secno">6.5.1.4 </span>Sample user interface</h5>

  <p><i>This section is non-normative.</i></p>
  <p>A simple implementation of this feature for a desktop Web browser
  might work as follows.</p>

  <p>The <code title="dom-navigator-registerContentHandler"><a href="#dom-navigator-registercontenthandler">registerContentHandler()</a></code>
  method could display a modal dialog box:</p>

  <p><img alt="The modal dialog box could have the title 'Content Handler Registration', and could say 'This Web page: Kittens at work http://kittens.example.org/ ...would like permission to handle files of type: application/x-meowmeow using the following Web-based application: Kittens-at-work displayer http://kittens.example.org/?show=%s Do you trust the administrators of the &quot;kittens.example.org&quot; domain?' with two buttons, 'Trust kittens.example.org' and 'Cancel'." height="374" src="images/sample-content-handler-registration.png" width="534"></p>

  <p>In this dialog box, "Kittens at work" is the title of the page
  that invoked the method, "http://kittens.example.org/" is the URL of
  that page, "application/x-meowmeow" is the string that was passed to
  the <code title="dom-navigator-registerContentHandler"><a href="#dom-navigator-registercontenthandler">registerContentHandler()</a></code>
  method as its first argument (<var title="">mimeType</var>),
  "http://kittens.example.org/?show=%s" was the second argument (<var title="">url</var>), and "Kittens-at-work displayer" was the third
  argument (<var title="">title</var>).</p>

  <p>If the user clicks the Cancel button, then nothing further
  happens. If the user clicks the "Trust" button, then the handler is
  remembered.</p>

  <p>When the user then attempts to fetch a URL that uses the
  "application/x-meowmeow" <a href="infrastructure.html#mime-type">MIME type</a>, then it might
  display a dialog as follows:</p>

  <p><img alt="The dialog box could have the title 'Unknown File Type' and could say 'You have attempted to access:' followed by a URL, followed by a prompt such as 'How would you like FerretBrowser to handle this resource?' with three radio buttons, one saying 'Contact the FerretBrowser plugin registry to see if there is an official way to handle this resource.', one saying 'Pass this URL to a local application' with an application selector, and one saying 'Pass this URL to the &quot;Kittens-at-work displayer&quot; application at &quot;kittens.example.org&quot;', with a checkbox labeled 'Always do this for resources using the &quot;application/x-meowmeow&quot; type in future.', and with two buttons, 'Ok' and 'Cancel'." height="428" src="images/sample-content-handler.png" width="577"></p>

  <p>In this dialog, the third option is the one that was primed by
  the site registering itself earlier.</p>

  <p>If the user does select that option, then the browser, in
  accordance with the requirements described in the previous two
  sections, will redirect the user to
  "http://kittens.example.org/?show=data%3Aapplication/x-meowmeow;base64,S2l0dGVucyBhcmUgdGhlIGN1dGVzdCE%253D".</p>

  <p>The <code title="dom-navigator-registerProtocolHandler"><a href="#dom-navigator-registerprotocolhandler">registerProtocolHandler()</a></code>
  method would work equivalently, but for schemes instead of unknown
  content types.</p>

  </div>



  <h5 id="manually-releasing-the-storage-mutex"><span class="secno">6.5.1.5 </span>Manually releasing the storage mutex</h5>

  <pre class="idl">[NoInterfaceObject]
interface <dfn id="navigatorstorageutils">NavigatorStorageUtils</dfn> {
  void <a href="#dom-navigator-yieldforstorageupdates" title="dom-navigator-yieldForStorageUpdates">yieldForStorageUpdates</a>();
};</pre>

  <dl class="domintro"><dt><var title="">window</var> . <code title="dom-navigator"><a href="#dom-navigator">navigator</a></code> . <code title="dom-navigator-yieldForStorageUpdates"><a href="#dom-navigator-yieldforstorageupdates">yieldForStorageUpdates</a></code>()</dt>

   <dd>

    <p>If a script uses the <code title="dom-document-cookie"><a href="dom.html#dom-document-cookie">document.cookie</a></code> API, or the
    <code title="dom-localStorage">localStorage</code> API, the
    browser will block other scripts from accessing cookies or storage
    until the first script finishes.
        <a href="references.html#refsWEBSTORAGE">[WEBSTORAGE]</a>
        </p>

    <p>Calling the <code title="dom-navigator-yieldForStorageUpdates"><a href="#dom-navigator-yieldforstorageupdates">navigator.yieldForStorageUpdates()</a></code>
    method tells the user agent to unblock any other scripts that may
    be blocked, even though the script hasn't returned.</p>

    <p>Values of cookies and items in the <code>Storage</code> objects
    of <code title="dom-localStorage">localStorage</code> attributes
    can change after calling this method, whence its name.
        <a href="references.html#refsWEBSTORAGE">[WEBSTORAGE]</a>
        </p>

   </dd>

  </dl><div class="impl">

   <p>The <dfn id="dom-navigator-yieldforstorageupdates" title="dom-navigator-yieldForStorageUpdates"><code>yieldForStorageUpdates()</code></dfn>
   method, when invoked, must, if the <a href="webappapis.html#storage-mutex">storage mutex</a> is
   owned by the <a href="webappapis.html#event-loop">event loop</a> of the <a href="webappapis.html#concept-task" title="concept-task">task</a> that resulted in the method being
   called, release the <a href="webappapis.html#storage-mutex">storage mutex</a> so that it is once
   again free. Otherwise, it must do nothing.</p>

  </div>


  <h4 id="the-external-interface"><span class="secno">6.5.2 </span>The <code><a href="#external">External</a></code> interface</h4>

  <div class="impl">

  <p>The <dfn id="dom-external" title="dom-external"><code>external</code></dfn>
  attribute of the <code><a href="browsers.html#window">Window</a></code> interface must return an
  instance of the <code><a href="#external">External</a></code> interface. The same object
  must be returned each time.</p>

  </div>

  <pre class="idl">interface <dfn id="external">External</dfn> {
  void <a href="#dom-external-addsearchprovider" title="dom-external-AddSearchProvider">AddSearchProvider</a>(DOMString engineURL);
  unsigned long <a href="#dom-external-issearchproviderinstalled" title="dom-external-IsSearchProviderInstalled">IsSearchProviderInstalled</a>(DOMString engineURL);
};</pre>

  <dl class="domintro"><dt><var title="">window</var> . <code title="dom-external"><a href="#dom-external">external</a></code> . <code title="dom-external-AddSearchProvider"><a href="#dom-external-addsearchprovider">AddSearchProvider</a></code>( <var title="">url</var> )</dt>
   <dd>

    <p>Adds the search engine described by the OpenSearch description
    document at <var title="">url</var>. <a href="references.html#refsOPENSEARCH">[OPENSEARCH]</a></p>

    <p>The OpenSearch description document has to be on the same
    server as the script that calls this method.</p>

   </dd>

   <dt><var title="">installed</var> = <var title="">window</var> . <code title="dom-external"><a href="#dom-external">external</a></code> . <code title="dom-external-IsSearchProviderInstalled"><a href="#dom-external-issearchproviderinstalled">IsSearchProviderInstalled</a></code>( <var title="">url</var> )</dt>
   <dd>

    <p>Returns a value based on comparing <var title="">url</var> to
    the URLs of the results pages of the installed search engines.</p>

    <dl><dt>0 </dt><dd>None of the installed search engines match <var title="">url</var>.
     </dd><dt>1 </dt><dd>One or more installed search engines match <var title="">url</var>, but none are the user's default search engine.
     </dd><dt>2 </dt><dd>The user's default search engine matches <var title="">url</var>.
    </dd></dl><p>The <var title="">url</var> is compared to the URLs of the
    results pages of the installed search engines using a prefix
    match. Only results pages on the same domain as the script that
    calls this method are checked.</p>

   </dd>

  </dl><p class="note">Another way of exposing search engines using
  OpenSearch description documents is using a <code><a href="the-link-element.html#the-link-element">link</a></code>
  element with the <code title="rel-search"><a href="links.html#link-type-search">search</a></code> link
  type.</p>

  <div class="impl">

   <p>The <dfn id="dom-external-addsearchprovider" title="dom-external-AddSearchProvider"><code>AddSearchProvider()</code></dfn>
   method, when invoked, must run the following steps:</p>

   <ol><li><p>Optionally, abort these steps. User agents may implement
    the method as a stub method that never does anything, or may
    arbitrarily ignore invocations with particular arguments for
    security, privacy, or usability reasons.</p></li>

    <li><p><a href="urls.html#resolve-a-url" title="resolve a url">Resolve</a> the value of the
    method's first argument relative to the <a href="browsers.html#entry-script">entry
    script</a>'s <a href="webappapis.html#script's-base-url" title="script's base URL">base
    URL</a>.</p></li>

    <li><p>If this fails, abort these steps.</p></li>

    <li><p>Process the resulting <a href="urls.html#absolute-url">absolute URL</a> as the
    <a href="urls.html#url">URL</a> to an OpenSearch description document. <a href="references.html#refsOPENSEARCH">[OPENSEARCH]</a></p></li>

   </ol><p>The <dfn id="dom-external-issearchproviderinstalled" title="dom-external-IsSearchProviderInstalled"><code>IsSearchProviderInstalled()</code></dfn>
   method, when invoked, must run the following steps:
   <!--INSERT FINGERPRINT-->
   </p>

   <ol><li><p>Optionally, return 0 and abort these steps. User agents may
    implement the method as a stub method that never returns a
    non-zero value, or may arbitrarily ignore invocations with
    particular arguments for security, privacy, or usability
    reasons.</p></li>

    <li><p>If the <a href="browsers.html#origin-0">origin</a> of the <a href="browsers.html#entry-script">entry script</a>
    is an opaque identifier (i.e. it has no host component), then
    return 0 and abort these steps.</p></li>

    <li><p>Let <var title="">host1</var> be the host component of the
    <a href="browsers.html#origin-0">origin</a> of the <a href="browsers.html#entry-script">entry script</a>.</p></li>

    <li><p><a href="urls.html#resolve-a-url" title="resolve a url">Resolve</a> the <var title="">scriptURL</var> argument relative to the <a href="browsers.html#entry-script">entry
    script</a>'s <a href="webappapis.html#script's-base-url" title="script's base URL">base
    URL</a>.</p></li>

    <li><p>If this fails, return 0 and abort these steps.</p></li>

    <li><p>Let <var title="">host2</var> be be the <a href="urls.html#url-host" title="url-host">&lt;host&gt;</a> component of the resulting
    <a href="urls.html#absolute-url">absolute URL</a>.</p></li>

    <li>

     <p>If the longest suffix in the Public Suffix List that matches
     the end of <var title="">host1</var> is different than the
     longest suffix in the Public Suffix List that matches the end of
     <var title="">host2</var>, then return 0 and abort these steps.
     <a href="references.html#refsPSL">[PSL]</a></p>

     <p>If the next domain component of <var title="">host1</var> and
     <var title="">host2</var> after their common suffix are not the
     same, then return 0 and abort these steps.</p>

     <p>Domain labels must be compared after applying the IDNA ToASCII
     algorithm to them, with both the AllowUnassigned and
     UseSTD3ASCIIRules flags set, in an <a href="infrastructure.html#ascii-case-insensitive">ASCII
     case-insensitive</a> manner. <a href="references.html#refsRFC3490">[RFC3490]</a></p>

    </li>

    <li><p>Let <var title="">search engines</var> be the list of
    search engines known by the user agent and made available to the
    user by the user agent for which the resulting <a href="urls.html#absolute-url">absolute
    URL</a> is a <a href="infrastructure.html#prefix-match">prefix match</a> of the search engine's
    <a href="urls.html#url">URL</a>, if any. For search engines registered using
    OpenSearch description documents, the <a href="urls.html#url">URL</a> of the
    search engine corresponds to the URL given in a <code title="">Url</code> element whose <code title="">rel</code>
    attribute is "<code title="">results</code>" (the default). <a href="references.html#refsOPENSEARCH">[OPENSEARCH]</a></p></li>

    <li><p>If <var title="">search engines</var> is empty, return 0
    and abort these steps.</p></li>

    <li><p>If the user's default search engine (as determined by the
    user agent) is one of the search engines in <var title="">search
    engines</var>, then return 2 and abort these steps.</p></li>

    <li><p>Return 1.</p></li>

   </ol></div>
<!--TOPIC:HTML-->



  </body></html>